{{ define "main" }}
<div class="hero is-dark is-fullheight-with-navbar" {{ with .Params.heroimage }}
  style="background: url({{ . }}) center bottom; background-size:cover;" {{ end }}>
  <div class="hero-body">
    <div class="container max-800px">
      <h1 class="tag skew title subtitle is-1 has-background-primary narrow-background">
        <span class="unskew">{{ .Title | upper }}</span>
      </h1>
      {{ with .Params.herotext }}
      <h2 class="skew title subtitle is-4 has-background-primary narrow-background">
        <span class="unskew">{{ . }}</span>
      </h2>
      {{ end }}
    </div>
  </div>
</div>

<div class="container max-800px">
  <div class="section">
    <div class="columns is-multiline">
      <div class="column is-two-third">
        {{ $accueil := (where .Site.RegularPages "Type" "in" "blog")}}
        {{ range first 1 $accueil }}
        {{ partial "widgets/post-card.html" . }}
        {{ end }}
      </div>
      <div class="column is-one-third">
        <div class="content">
          {{ .Summary }}
        </div>
        <hr>
        {{ range $taxonomy_name, $taxonomy := .Site.Taxonomies }}
        {{ if (ne $taxonomy_name "categories") }}
        <aside class="menu">
          <p class="menu-label">{{ $taxonomy_name }}</p>
          <ul class="menu-list">
              {{ with ($.Site.GetPage (printf "/%s" $taxonomy_name)) }}
              {{ range .Pages.ByWeight }}
              <a class="list-group-item list-group-item-action text-capitalize" href="{{ .RelPermalink }}">{{ .Title }} <small class="tag">{{ .Params.year }}</small>
                {{ $pageCount := len .Pages }}
                <small class="tag is-primary">{{ $pageCount }}</small></a>
              {{ end }}
              {{ end }}
          </ul>
        </aside>
        <hr>
        {{ end }}
        {{ end }}
      <aside class="menu">
        <p class="menu-label">Cat√©gories</p>
        <ul class="menu-list">
            {{ with ($.Site.GetPage (printf "/%s" "categories")) }}
            {{ range .Pages.ByWeight }}
            <a class="list-group-item list-group-item-action text-capitalize" href="{{ .RelPermalink }}">{{ .Title }} 
              {{ $pageCount := len .Pages }}
              <small class="tag is-primary">{{ $pageCount }}</small></a>
            {{ end }}
            {{ end }}
        </ul>
      </aside>
      <hr>
    </div>
  </div>
  <div class="section">
    <div class="content">
      <h3>Les derniers articles</h3>
    </div>
    <div class="columns">
      {{ range (where .Site.RegularPages "Type" "blog") | after 1 | first 3 }}
      <div class="column is-one-third">
        {{ partial "widgets/post-card-small.html" . }}
      </div>
      {{ end }}
    </div>

    <div class="content">
      <h3>Tous les voyages</h3>
    </div>
    <div class="columns is-mobile is-multiline">

      {{ range $name, $items := .Site.Taxonomies.voyages }}
      {{ with partial "func/GetTermPage" (dict "taxonomy" "voyages" "term" $name) }}
      <div class="column is-half-mobile is-one-third-tablet is-one-third-desktop is-one-quarter-widescreen">
        <div class="card">
          <div class="card-image">
            <a href="{{ .RelPermalink }}">
              <figure class="image is-3by2">
                {{ $firstChild := index $items 0 }}
                {{ with $firstChild.Params.images }}
                <img src="{{ index . 0 }}" alt="">
                {{ end }}
              </figure>
            </a>
          </div>
          <div class="card-content has-text-centered">
            <div>
              <a class="title is-5 is-size-6-mobile" href="{{ .RelPermalink }}"> {{ .Title }}</a>

              <p> {{ len $items }} article{{ if ne (len $items) 1 }}s{{ end }} </p>
              <small class="tag">{{ .Params.year }}</small>
            </div>
          </div>
        </div>
      </div>
      {{ end }}
      {{ end }}
    </div>
  </div>
</div>

{{ end }}